apiVersion: networking.istio.io/v1alpha3
kind: Gateway
metadata:
  name: 'frontend-gateway'
  namespace: 'ecommerce-demo'
  labels:
    app: 'frontend'
    gateway-type: 'public'
  annotations:
    istio.io/description: "Advanced gateway configuration for frontend"
spec:
  selector:
    istio: 'aks-istio-ingressgateway-external'
  servers:
  # HTTP Server (redirect to HTTPS)
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - 'ecommerce-demo.example.com'
    tls:
      httpsRedirect: true
  
  # HTTPS Server (main)
  - port:
      number: 443
      name: https
      protocol: HTTPS
    hosts:
    - 'ecommerce-demo.example.com'
    tls:
      mode: 'SIMPLE'
      credentialName: 'ecommerce-tls'
      minProtocolVersion: 'TLSV1_2'
      maxProtocolVersion: 'TLSV1_3'
      cipherSuites:
      - ECDHE-RSA-AES256-GCM-SHA384
      - ECDHE-RSA-AES128-GCM-SHA256
      - ECDHE-RSA-CHACHA20-POLY1305
      - ECDHE-ECDSA-AES256-GCM-SHA384
      - ECDHE-ECDSA-AES128-GCM-SHA256
      - ECDHE-ECDSA-CHACHA20-POLY1305
