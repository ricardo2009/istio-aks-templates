---
apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: {{ .Values.network.gateway.name }}
  namespace: {{ .Values.network.gateway.namespace }}
  labels:
    app: {{ .Values.app.name }}
    version: {{ .Values.app.version }}
    environment: {{ .Values.metadata.labels.environment }}
    managed-by: {{ .Values.metadata.labels.managed_by }}
    business_unit: {{ .Values.metadata.labels.business_unit }}
  annotations:
    owner: {{ .Values.metadata.annotations.owner }}
    "istio-templates.io/category": "traffic-management"
    "istio-templates.io/component": "gateway"
spec:
  selector:
    istio: aks-istio-ingressgateway-external
  servers:
  - port:
      number: 443
      name: https
      protocol: HTTPS
    hosts:
    - {{ .Values.network.gateway.hosts[0] }}
    tls:
      mode: SIMPLE
      credentialName: {{ .Values.network.gateway.tls.secretName }}